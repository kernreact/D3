<!DOCTYPE html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="./styles.css"></link>
        <script type="text/javascript" src="../d3.v6.js"></script>
        <title>My Histogram</title>
    </head>
    <body>
      <script type="text/javascript">

        //Original data
      
			const dataset = {
				nodes: [
					{ name: "Adam" },
					{ name: "Bob" },
					{ name: "Carrie" },
					{ name: "Donovan" },
					{ name: "Edward" },
					{ name: "Felicity" },
					{ name: "George" },
					{ name: "Hannah" },
					{ name: "Iris" },
					{ name: "Jerry" }
				],
				edges: [
					{ source: 0, target: 1 },
					{ source: 0, target: 2 },
					{ source: 0, target: 3 },
					{ source: 0, target: 4 },
					{ source: 1, target: 5 },
					{ source: 2, target: 5 },
					{ source: 2, target: 5 },
					{ source: 3, target: 4 },
					{ source: 5, target: 8 },
					{ source: 5, target: 9 },
					{ source: 6, target: 7 },
					{ source: 7, target: 8 },
					{ source: 8, target: 9 }
				]
			};

      

        const links = dataset.edges;
        const nodes = dataset.nodes;

        console.log("data", nodes, links);

        //Width and height
          const w = 500;
          const  h = 300;

          const colors = d3.scaleOrdinal(d3.schemeCategory10);

          const simulation = d3.forceSimulation(nodes)
            .force("charge", d3.forceManyBody())
            .force("link", d3.forceLink(links))
            .force("center", d3.forceCenter().x(w/2).y(h/2));
          
          // define drag event functions
          const drag = (simulation) => {
            const dragStarted = (e, d) => {
              if (!e.active) force.alphaTarget(0.3).restart();
              d.fx = d.x;
              d.fy = d.y;
              }
              
            const dragging = (e, d) => {
              d.fx = e.x;
              d.fy = e.y;
            }
              
            const dragEnded = (e, d) => {
              if (!e.active) force.alphaTarget(0);
              d.fx = null;
              d.fy = null;
            }
          }


          //Create SVG element
          const svg = d3.select("body")
          .append("svg")
          .attr("width", w)
          .attr("height", h);

          // create edges as lines
          const link = svg.append("g")
              .attr("stroke", "#999")
              .attr("stroke-opacity", 0.6)
            .selectAll("line")
            .data(dataset.edges)
            .join("line");

          // create a circle for each node
          const node = svg.append("g")
              .attr("fill", "#fff")
              .attr("stroke", "#000")
              .attr("stroke-width", 1.5)
            .selectAll("circle")
            .data(dataset.nodes)
            .join("circle")
              .attr("fill", (d, i) => { return colors(i)})
              .attr("r", 10)
              .call(d3.drag(simulation));

            
              

         /* const circle = d3.selectAll("circle")
            .call(d3.drag()
              .on("start", (d) => circle.filter(p => p === d).raise().attr("stroke", "red"))
              .on("drag", (event, d) => (d.x = event.x, d.y = event.y))
              .on("end", nodes.filter(p => p === d).attr("stroke", null)));

        */
          // every time the simulation "ticks", this will be called
          simulation.on("tick", () => {
            link
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);

            node
              .attr("cx", d => d.x)
              .attr("cy", d => d.y);
          });
      
        
          
          

        
      </script>
    </body>

</html>